<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Random Star Draw</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            text-align: center;
        }
        button {
            font-size: 18px;
            padding: 10px 20px;
            margin: 20px 5px;
        }
        #result, #listSummary {
            margin-top: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <h1>Random Star Draw</h1>
    <div>
        <label for="listNum">List number (1-8):</label>
        <input type="number" id="listNum" min="1" max="8" value="1">
    </div>
    <div>
        <label for="numStars">Number of stars to draw:</label>
        <input type="number" id="numStars" min="1" value="1">
    </div>
    <button onclick="drawStars()">Draw Stars</button>
    <button onclick="clearAllData()">Clear All Data</button>
    <div id="listSummary"></div>
    <div id="result"></div>

    <script>
        const starLists = [
            [
                {name: "天狼星", magnitude: -1.46, constellation: "大犬座"},
                {name: "弧矢七", magnitude: 1.5, constellation: "大犬座"},
                {name: "弧矢一", magnitude: 1.82, constellation: "大犬座"},
                {name: "軍市一", magnitude: 1.99, constellation: "大犬座"},
                {name: "弧矢二", magnitude: 2.45, constellation: "大犬座"}
            ],
            // ... (other lists remain the same)
        ];

        let drawnStars = [];
        let listDrawCounts = Array(8).fill(0);
        let listDrawNames = Array(8).fill().map(() => []);

        // Load data from local storage when the page loads
        window.onload = function() {
            loadFromLocalStorage();
            updateTable();
            updateListSummary();
        };

        function drawStars() {
            const listNum = parseInt(document.getElementById('listNum').value) - 1;
            const numStars = parseInt(document.getElementById('numStars').value);
            const stars = starLists[listNum];

            for (let i = 0; i < numStars; i++) {
                const randomIndex = Math.floor(Math.random() * stars.length);
                const drawnStar = stars[randomIndex];
                drawnStars.push(drawnStar);
                listDrawNames[listNum].push(drawnStar.name);
            }

            listDrawCounts[listNum] += numStars;
            updateTable();
            updateListSummary();
            saveToLocalStorage();
        }

        function updateTable() {
            const result = document.getElementById('result');
            let tableHTML = `
                <table>
                    <tr>
                        <th>Star Name</th>
                        <th>Magnitude</th>
                        <th>Constellation</th>
                    </tr>
            `;

            drawnStars.forEach(star => {
                tableHTML += `
                    <tr>
                        <td>${star.name}</td>
                        <td>${star.magnitude}</td>
                        <td>${star.constellation}</td>
                    </tr>
                `;
            });

            tableHTML += '</table>';
            result.innerHTML = tableHTML;
        }

        function updateListSummary() {
            const listSummary = document.getElementById('listSummary');
            let summaryHTML = `
                <table>
                    <tr>
                        <th>List Number</th>
                        <th>Stars Drawn</th>
                        <th>Star Names</th>
                    </tr>
            `;

            listDrawCounts.forEach((count, index) => {
                summaryHTML += `
                    <tr>
                        <td>List ${index + 1}</td>
                        <td>${count}</td>
                        <td>${listDrawNames[index].join(", ")}</td>
                    </tr>
                `;
            });

            summaryHTML += '</table>';
            listSummary.innerHTML = summaryHTML;
        }

        function saveToLocalStorage() {
            localStorage.setItem('drawnStars', JSON.stringify(drawnStars));
            localStorage.setItem('listDrawCounts', JSON.stringify(listDrawCounts));
            localStorage.setItem('listDrawNames', JSON.stringify(listDrawNames));
        }

        function loadFromLocalStorage() {
            const savedDrawnStars = localStorage.getItem('drawnStars');
            const savedListDrawCounts = localStorage.getItem('listDrawCounts');
            const savedListDrawNames = localStorage.getItem('listDrawNames');

            if (savedDrawnStars) {
                drawnStars = JSON.parse(savedDrawnStars);
            }
            if (savedListDrawCounts) {
                listDrawCounts = JSON.parse(savedListDrawCounts);
            }
            if (savedListDrawNames) {
                listDrawNames = JSON.parse(savedListDrawNames);
            }
        }

        function clearAllData() {
            localStorage.removeItem('drawnStars');
            localStorage.removeItem('listDrawCounts');
            localStorage.removeItem('listDrawNames');
            drawnStars = [];
            listDrawCounts = Array(8).fill(0);
            listDrawNames = Array(8).fill().map(() => []);
            updateTable();
            updateListSummary();
        }
    </script>
</body>
</html>