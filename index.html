<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Random Star Draw</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            text-align: center;
        }
        button {
            font-size: 18px;
            padding: 10px 20px;
            margin: 20px 5px;
        }
        #result {
            margin-top: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <h1>Random Star Draw</h1>
    <div>
        <label for="numStars">Number of stars to draw:</label>
        <input type="number" id="numStars" min="1" value="1">
    </div>
    <button onclick="drawStars()">Draw Stars</button>
    <button onclick="clearAllData()">Clear All Data</button>
    <div id="result"></div>

    <script>
        const allStars = [
            {name: "天狼星", magnitude: -1.46, constellation: "大犬座"},
            {name: "弧矢七", magnitude: 1.5, constellation: "大犬座"},
            {name: "弧矢一", magnitude: 1.82, constellation: "大犬座"},
            {name: "軍市一", magnitude: 1.99, constellation: "大犬座"},
            {name: "弧矢二", magnitude: 2.45, constellation: "大犬座"},
            {name: "老人星", magnitude: -0.74, constellation: "船底座"},
            {name: "南船五", magnitude: 1.69, constellation: "船底座"},
            {name: "海石一", magnitude: 1.86, constellation: "船底座"},
            {name: "海石二", magnitude: 2.21, constellation: "船底座"},
            {name: "南船三", magnitude: 2.76, constellation: "船底座"},
            {name: "南門二", magnitude: -0.27, constellation: "半人馬座"},
            {name: "馬腹一", magnitude: 0.61, constellation: "半人馬座"},
            {name: "庫樓三", magnitude: 2.06, constellation: "半人馬座"},
            {name: "庫樓七", magnitude: 2.17, constellation: "半人馬座"},
            {name: "南門一", magnitude: 2.3, constellation: "半人馬座"},
            {name: "大角星", magnitude: -0.05, constellation: "牧夫座"},
            {name: "梗河一", magnitude: 2.37, constellation: "牧夫座"},
            {name: "右攝提一", magnitude: 2.68, constellation: "牧夫座"},
            {name: "織女一", magnitude: 0.03, constellation: "天琴座"},
            {name: "五車二", magnitude: 0.08, constellation: "御夫座"},
            {name: "五車五", magnitude: 1.65, constellation: "御夫座"},
            {name: "參宿七", magnitude: 0.13, constellation: "獵戶座"},
            {name: "參宿四", magnitude: 0.42, constellation: "獵戶座"},
            {name: "參宿五", magnitude: 1.64, constellation: "獵戶座"},
            {name: "南河三", magnitude: 0.34, constellation: "小犬座"},
            {name: "南河二", magnitude: 2.89, constellation: "小犬座"},
            {name: "水尾一", magnitude: 0.46, constellation: "波江座"},
            {name: "玉井三", magnitude: 2.8, constellation: "波江座"},
            {name: "天園六", magnitude: 2.88, constellation: "波江座"}
        ];

        const constellationOrder = [
            "白羊座", "金牛座", "雙子座", "巨蟹座", "獅子座", "室女座",
            "天秤座", "天蠍座", "人馬座", "摩羯座", "寶瓶座", "雙魚座",
            "大犬座", "船底座", "半人馬座", "牧夫座", "天琴座", "御夫座",
            "獵戶座", "小犬座", "波江座"
        ];

        let drawnStars = [];

        window.onload = function() {
            loadFromLocalStorage();
            updateTable();
        };

        function drawStars() {
            const numStars = parseInt(document.getElementById('numStars').value);
            const availableStars = allStars.filter(star => !drawnStars.some(drawnStar => drawnStar.name === star.name));

            for (let i = 0; i < numStars && availableStars.length > 0; i++) {
                const randomIndex = Math.floor(Math.random() * availableStars.length);
                const drawnStar = availableStars.splice(randomIndex, 1)[0];
                drawnStars.push(drawnStar);
            }

            updateTable();
            saveToLocalStorage();
        }

        function updateTable() {
            const result = document.getElementById('result');
            const constellations = {};

            drawnStars.forEach(star => {
                if (!constellations[star.constellation]) {
                    constellations[star.constellation] = [];
                }
                constellations[star.constellation].push(star);
            });

            let tableHTML = '';

            constellationOrder.forEach(constellation => {
                if (constellations[constellation]) {
                    tableHTML += `
                        <h2>${constellation}</h2>
                        <table>
                            <tr>
                                <th>Star Name</th>
                                <th>Magnitude</th>
                            </tr>
                    `;

                    constellations[constellation].forEach(star => {
                        tableHTML += `
                            <tr>
                                <td>${star.name}</td>
                                <td>${star.magnitude}</td>
                            </tr>
                        `;
                    });

                    tableHTML += '</table>';
                }
            });

            result.innerHTML = tableHTML;
        }

        function saveToLocalStorage() {
            localStorage.setItem('drawnStars', JSON.stringify(drawnStars));
        }

        function loadFromLocalStorage() {
            const savedDrawnStars = localStorage.getItem('drawnStars');
            if (savedDrawnStars) {
                drawnStars = JSON.parse(savedDrawnStars);
            }
        }

        function clearAllData() {
            localStorage.removeItem('drawnStars');
            drawnStars = [];
            updateTable();
        }
    </script>
</body>
</html>